---
import { CldUploadWidget } from 'astro-cloudinary';
---
<CldUploadWidget uploadPreset={process.env.PUBLIC_CLOUDINARY_UPLOAD_PRESET} id="upload">
  <button class="btn btn-primary">Upload</button>
</CldUploadWidget>

<div id="result" class="break-words whitespace-normal overflow-auto"></div>

<script>
  interface CloudinaryEventDetail {
    event: string;
    info: Record<string, any>;
    uploadWidget: any;
  }
  
  const widget = document.querySelector('#upload');
  const resultContainer = document.querySelector('#result');
  
  if (widget && resultContainer) {
    widget.addEventListener('clduploadwidget:success', (e: Event) => {
      const customEvent = e as CustomEvent<CloudinaryEventDetail>;
      resultContainer.textContent = JSON.stringify(customEvent.detail.info);
    });
  }
  </script>